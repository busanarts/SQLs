-- 정원내 제적생수(금학기)
SELECT 학과명,
MAX(DECODE(학년, '1', CNT, 0)) "1학년 제적",
MAX(DECODE(학년, '2', CNT, 0)) "2학년 제적"
FROM
(
	SELECT 학과명, HJ_HAKNYUN 학년, COUNT(*) CNT  FROM AC12011_2013_04_01, (
		SELECT HC_HAKBUN, HC_SCODE, HC_SIYMD FROM AC1202_2013_04_01 A
		WHERE (HC_HAKBUN, HC_SIYMD) IN (SELECT HC_HAKBUN, MAX(HC_SIYMD) FROM AC1202_2013_04_01
		WHERE HC_SIYMD >= &NowYear - 1 || '1001' AND HC_SIYMD <= &NowYear || '0331' AND SUBSTR(HC_SCODE,1,1) = '2'
		GROUP BY HC_HAKBUN)
	), AC1121, TBL학과
	WHERE HJ_JHGBN >= '50'
    AND hj_hakbun NOT LIKE 'T%'
    AND HJ_HAKBUN = HC_HAKBUN
	AND HJ_HGCODE = HG_CODE AND HG_MCODE = 학과코드
	GROUP BY 학과명, 주야구분, HJ_HAKNYUN
)
GROUP BY 학과명
ORDER BY 학과명
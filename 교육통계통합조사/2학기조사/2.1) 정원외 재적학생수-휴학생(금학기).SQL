SELECT 학과명, HJ_HAKNYUN 학년, COUNT(*) 금학기휴학인원,
SUM(DECODE(HC_SCODE, '12', 1, '13', 1, 0)) 군입대휴학,
SUM(CASE WHEN HJ_SEXGBN = '1' THEN DECODE(HC_SCODE, '11', 1, '14', 1, '15', 1, 0) END) 개인사정휴학남,
SUM(CASE WHEN HJ_SEXGBN = '2' THEN DECODE(HC_SCODE, '11', 1, '14', 1, '15', 1, 0) END) 개인사정휴학여
FROM AC12011_2013_04_01, AC1202_2013_04_01, AC1121, TBL학과
WHERE HJ_HAKBUN = HC_HAKBUN
AND HJ_JHGBN >= '50'
AND SUBSTR(HC_SCODE,1,1) = '1'
AND HJ_HAKBUN NOT LIKE 'T%'
AND HC_SIYMD >= :학년도 - 1 || '1001' AND HC_SIYMD <= :학년도 || '0331'
AND HJ_HGCODE = HG_CODE AND HG_MCODE = 학과코드
GROUP BY 학과명, HJ_HAKNYUN
ORDER BY 학과명, HJ_HAKNYUN
-- 정원내 제적생수(금학기)

	SELECT 학과명, HJ_HAKNYUN 학년, COUNT(*) 제적인원
  FROM AC12011_2012_10_01, (
		SELECT HC_HAKBUN, HC_SCODE, HC_SIYMD FROM AC1202_2012_10_01 A
		WHERE (HC_HAKBUN, HC_SIYMD) IN (SELECT HC_HAKBUN, MAX(HC_SIYMD) FROM AC1202_2012_10_01
		WHERE HC_SIYMD >= :학년도 || '0401' AND HC_SIYMD <= :학년도 || '0931' AND SUBSTR(HC_SCODE,1,1) = '2'
		GROUP BY HC_HAKBUN)
	), AC1121, TBL학과
	WHERE HJ_JHGBN >= '50'
    AND hj_hakbun NOT LIKE 'T%'
    AND HJ_HAKBUN = HC_HAKBUN
	AND HJ_HGCODE = HG_CODE AND HG_MCODE = 학과코드
	GROUP BY CUBE(학과명, HJ_HAKNYUN)
  ORDER BY 학과명, hj_haknyun
